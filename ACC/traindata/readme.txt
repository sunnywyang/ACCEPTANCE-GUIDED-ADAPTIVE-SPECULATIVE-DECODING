1、先运行gen_dataset.py
python3 gen_dataset.py --dataset_name tatsu-lab/alpaca --model_name 7b --mode hf --do_sample --output_file /root/autodl-fs/SpecDec_pp-main/SpecDec_pp-main/data/tmp/tmp1.json
2、gen_assistant.py
python3 gen_assistant.py  --do_sample --input_file /root/autodl-tmp/autodl-tmp/SpecDec_pp-main/tmp1.json --output_file /root/autodl-tmp/autodl-tmp/SpecDec_pp-main/tmp2.json

3、python3 gen_log_p_draft.py --input_file /root/autodl-tmp/SpecDec_pp-main/tmp2.json --output_file /root/autodl-tmp/SpecDec_pp-main/tmp3.json

4、python gen_log_p_draft.py --input_file /root/autodl-tmp/SpecDec_pp-main/specdec_pp/data/llama_13b_data/tmp3.json --output_file /root/autodl-tmp/SpecDec_pp-main/specdec_pp/data/llama_13b_data/tmp4.json

5、python3 gen_acceptance.py --target_name ${TARGET} --draft_name ${DRAFT} --input_file $TMP4 --output_file ${OUT}/${FINAL}


6、Next, run the following python script to split the alpaca_data `all.json` into `train.json` (40k), `dev.json` (10k), `test.json` (2k). 

```
python split_dataset.py all.json 40000 10000 2000
```

Run the following script to generate the humanEval dataset (test-only):

```
sh gen_data.sh humaneval_data test.json openai_humaneval
```


3. Run the following script to generate the GSM8K dataset (test-only):

```
sh gen_data.sh gsm8k_test_data test.json gsm8k_test
```

### Data Format

Each `json` file is a `list` of `dict` containing the following keys:

```
prompt: str, the prompt. 
prefix: list[int], tokenized prompt.
continuation: str, the response generated by the target model. 
tokens: list[int], tokenized continuation.
draft: list[int], next tokens generated from the draft model conditioned on target model's generation.
log_p_7b: list[float], the log probabilities of the draft tokens predicted by the draft model (7b).
log_p_70b: list[float], the log probabilities of the draft tokens predicted by the target model (70b).
p_acc: list[float], the acceptance probabilities of the draft tokens.
```